import React from 'react';
import PureRenderMixin from 'react-addons-pure-render-mixin';
import classnames from 'classnames';
import { Tooltip } from 'antd';
import 'antd/lib/tooltip/style/css'

import './styles.css'

const defaultTooltipText = (count, date) => {
  return <span>{`${date} : ${count}`}</span>
}

class Day extends React.Component {
  constructor() {
    super();
    this.shouldComponentUpdate = PureRenderMixin.shouldComponentUpdate.bind(this);
  }

  state = {
    hovered: false,
  };

  mouseEnter = () => {
    this.setState({
      hovered: true,
    })
  }

  mouseLeave = () => {
    this.setState({
      hovered: false,
    })
  }


  render = () => {
    const {
      postCount,
      date,
      classNames = classnames('blue', 'is-level-2'),
      canHover = false,
      tooltipText = defaultTooltipText,
    } = this.props;

    const hoveredClass = {
      'is-hovered': canHover && this.state.hovered,
    };
    if (!canHover) {
      return (
        <div
          onMouseEnter={this.mouseEnter}
          onMouseLeave={this.mouseLeave}
          className={classnames('cal-heatmap_day', hoveredClass, classNames)}
        />
      )
    }

    return (
      <Tooltip
        title={tooltipText(postCount, date)}
      >
        <div
          onMouseEnter={this.mouseEnter}
          onMouseLeave={this.mouseLeave}
          className={classnames('cal-heatmap_day', hoveredClass, classNames)}
        />
      </Tooltip>
    );
  }
}

export default Day;
